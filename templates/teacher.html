<!DOCTYPE html>
<html>
<head>
  <title>Teacher Dashboard</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body class="bg-light">

<div class="position-relative mb-4">

    <!-- Centered welcome text -->
    <h3 class="text-center mb-0">
        Welcome {{ teacher_name }}
    </h3>

    <!-- Right-aligned buttons -->
    <div class="position-absolute top-50 end-0 translate-middle-y">
        <a href="{{ url_for('change_password') }}"
           class="btn btn-outline-secondary btn-sm me-2">
            Change Password
        </a>
        
        <a href="{{ url_for('logout') }}"
           class="btn btn-danger btn-sm">
            Logout
        </a>
    </div>

</div>

  <!-- Tabs -->
  <ul class="nav nav-tabs justify-content-center mb-4">
    <li class="nav-item">
      <button class="nav-link active" data-bs-toggle="tab" data-bs-target="#create">
        Create Lesson
      </button>
    </li>

    <li class="nav-item">
      <button class="nav-link" data-bs-toggle="tab" data-bs-target="#my-lessons">
        My Lessons
      </button>
    </li>

    <li class="nav-item">
      <button class="nav-link" data-bs-toggle="tab" data-bs-target="#submitted">
        Submitted Lessons
      </button>
    </li>

    <li class="nav-item">
      <button class="nav-link" data-bs-toggle="tab" data-bs-target="#history">
        Lesson History
      </button>
    </li>
  </ul>

  <div class="tab-content">

<!-- ================= CREATE LESSON ================= -->
<div class="tab-pane fade show active" id="create">

<form method="POST">

<!-- BASIC INFO -->
<div class="row">
  <div class="col-md-6 mb-3">
    <label>Subject</label>
    <input type="text" name="subject" class="form-control" required>
  </div>

  <div class="col-md-6 mb-3">
    <label>Class</label>
    <input type="text" name="class_name" class="form-control" required>
  </div>
</div>

<div class="row">
  <div class="col-md-4 mb-3">
    <label>Week Ending</label>
    <input type="date" name="week_ending" class="form-control" required>
  </div>

  <div class="col-md-4 mb-3">
    <label>Class Size</label>
    <input type="number" name="class_size" class="form-control">
  </div>

  <div class="col-md-4 mb-3">
    <label>Day</label>
    <select name="day" class="form-control" required>
    <option value="">-- Select Day --</option>
    <option value="Monday">Monday</option>
    <option value="Tuesday">Tuesday</option>
    <option value="Wednesday">Wednesday</option>
    <option value="Thursday">Thursday</option>
    <option value="Friday">Friday</option>
</select>
  </div>
</div>

<div class="row">
  <div class="col-md-6 mb-3">
    <label>Period</label>
    <input type="text" name="period" class="form-control">
  </div>

  <div class="col-md-6 mb-3">
    <label>Lesson</label>
    <input type="text" name="lesson_title" class="form-control">
  </div>
</div>

<hr>

<!-- CURRICULUM INFO -->
<div class="mb-3">
  <label>Strand</label>
  <input type="text" name="strand" class="form-control">
</div>

<div class="mb-3">
  <label>Sub-Strand</label>
  <input type="text" name="sub_strand" class="form-control">
</div>

<div class="mb-3">
  <label>Indicator (Code)</label>
  <input type="text" name="indicator_code" class="form-control">
</div>

<div class="mb-3">
  <label>Content Standard (Code)</label>
  <input type="text" name="content_standard_code" class="form-control">
</div>

<div class="mb-3">
  <label>Performance Indicator</label>
  <textarea name="performance_indicator" class="form-control"></textarea>
</div>

<div class="mb-3">
  <label>Core Competencies</label>
  <textarea name="core_competencies" class="form-control"></textarea>
</div>

<div class="mb-3">
  <label>Keywords</label>
  <textarea name="keywords" class="form-control"></textarea>
</div>

<div class="mb-3">
  <label>T.L.R(s)</label>
  <textarea name="tlr" class="form-control"></textarea>
</div>

<div class="mb-3">
  <label>Reference</label>
  <textarea name="reference" class="form-control"></textarea>
</div>

<hr>

<!-- LESSON PHASES -->
<div class="mb-3">
  <label>Phase 1: Starter</label>
  <textarea name="phase1" class="form-control" rows="3"></textarea>
</div>

<div class="mb-3">
  <label>Phase 2: Main</label>
  <textarea name="phase2" class="form-control" rows="4"></textarea>
</div>

<div class="mb-3">
  <label>Phase 3: Plenary / Reflection</label>
  <textarea name="phase3" class="form-control" rows="3"></textarea>
</div>

<button class="btn btn-success w-100">
  Save Lesson (Pending)
</button>

</form>
</div>

<!-- ================= MY LESSONS ================= -->
<div class="tab-pane fade" id="my-lessons">

{% if lessons %}
<table class="table table-bordered table-striped">
  <thead class="table-dark">
    <tr>
      <th>Subject</th>
      <th>Class</th>
      <th>Lesson</th>
      <th>Date</th>
      <th>Status</th>
      <th>Action</th>
    </tr>
  </thead>
  <tbody>
  {% for lesson in lessons %}
    <tr>
      <td>{{ lesson.subject }}</td>
      <td>{{ lesson.class_name }}</td>
      <td>{{ lesson.lesson_title }}</td>
      <td>{{ lesson.date_created.strftime('%d %b %Y') }}</td>
      <td>
        <span class="badge bg-secondary">{{ lesson.status }}</span>
      </td>
      <td>
  {% if lesson.status == 'pending' %}

    <a href="{{ url_for('edit_lesson', lesson_id=lesson.id) }}"
       class="btn btn-sm btn-primary mb-1">
      Edit
    </a>
    <a href="{{ url_for('teacher_view_lesson', lesson_id=lesson.id) }}"
   class="btn btn-sm btn-info mt-1">
  View
</a>
<a href="{{ url_for('export_lesson', lesson_id=lesson.id) }}" target="_blank" class="btn btn-primary">
    Export PDF
</a>

    <form method="POST"
          action="{{ url_for('submit_lesson', lesson_id=lesson.id) }}"
          style="display:inline;">
      <button type="submit" class="btn btn-sm btn-success">
        Submit
      </button>
    </form>

  {% else %}
    <span class="text-muted">Locked</span>
  {% endif %}
</td>


    </tr>
  {% endfor %}
  </tbody>
</table>
{% else %}
  <div class="alert alert-info text-center">
    Your saved lessons will appear here.
  </div>
{% endif %}

</div>

<!-- LESSON HISTORY TAB -->
<div class="tab-pane fade" id="history">

  {% if lessons %}
  <table class="table table-bordered table-striped mt-3">
    <thead class="table-dark">
      <tr>
        <th>Subject</th>
        <th>Class</th>
        <th>Date</th>
        <th>Lesson</th>
        <th>Status</th>
        <th>Feedback</th>
      </tr>
    </thead>

    <tbody>
    {% for lesson in lessons %}
      <tr>
        <td>{{ lesson.subject }}</td>
        <td>{{ lesson.class_name }}</td>
        <td>{{ lesson.date_created.strftime('%d %b %Y') }}</td>
        <td>{{ lesson.lesson_title }}</td>
        <td>
          <span class="badge 
            {% if lesson.status == 'approved' %}bg-success
            {% elif lesson.status == 'rejected' %}bg-danger
            {% elif lesson.status == 'submitted' %}bg-warning
            {% else %}bg-secondary{% endif %}">
            {{ lesson.status }}
          </span>
        </td>
        <td>
          {% if lesson.feedback %}
            {{ lesson.feedback }}
          {% else %}
            <em>No feedback yet</em>
          {% endif %}
        </td>
      </tr>
    {% endfor %}
    </tbody>
  </table>

  {% else %}
    <div class="alert alert-info text-center mt-3">
      No lesson history yet.
    </div>
  {% endif %}

</div>

<!-- ================= SUBMITTED LESSONS ================= -->
<div class="tab-pane fade" id="submitted">

{% if submitted_lessons %}
<table class="table table-bordered table-striped">
  <thead class="table-dark">
    <tr>
      <th>Subject</th>
      <th>Class</th>
      <th>Date</th>
      <th>Lesson</th>
      <th>Status</th>
      <th>Feedback</th>
      <th>Action</th>
    </tr>
  </thead>
  <tbody>
{% for lesson in submitted_lessons %}
  <tr>
    <!-- Subject -->
    <td>{{ lesson.subject }}</td>

    <!-- Class -->
    <td>{{ lesson.class_name }}</td>

    <!-- Date -->
    <td>{{ lesson.date_created.strftime('%d %b %Y') }}</td>

    <!-- Lesson -->
    <td>{{ lesson.lesson_title }}</td>

    <!-- Status -->
    <td>
      <span class="badge 
        {% if lesson.status == 'approved' %}bg-success
        {% elif lesson.status == 'rejected' %}bg-danger
        {% else %}bg-warning{% endif %}">
        {{ lesson.status }}
      </span>
    </td>

    <!-- Feedback -->
    <td>
      {% if lesson.feedback %}
        {{ lesson.feedback }}
      {% else %}
        <em>No feedback yet</em>
      {% endif %}
    </td>

    <!-- Action -->
    <td>
      <a href="{{ url_for('teacher_view_lesson', lesson_id=lesson.id) }}"
         class="btn btn-sm btn-outline-primary">
        View
      </a>
    </td>
  </tr>
{% endfor %}
</tbody>
</table>
{% else %}
  <div class="alert alert-info text-center">
    No submitted lessons yet.
  </div>
{% endif %}

</div>

</div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>